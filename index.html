<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>С Праздником святого Николая!</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  background: black;
  color: white;
  font-family: Arial, sans-serif;
  text-align: center;
  overflow: hidden;
}

/* КНОПКА */
button {
  position: relative;
  z-index: 10;
  margin-top: 40vh;
  padding: 16px 36px;
  font-size: 22px;
  border-radius: 40px;
  border: none;
  cursor: pointer;
}

/* ТЕКСТ */
#greeting {
  position: relative;
  z-index: 10;
  margin-top: 30px;
  font-weight: 900;
  text-align: center;

  font-size: clamp(28px, 6vw, 64px);
  line-height: 1.2;
  color: #fff;

  text-shadow:
    0 1px 0 #ccc,
    0 2px 0 #bbb,
    0 3px 0 #aaa,
    0 4px 0 #999,
    0 8px 15px rgba(0,0,0,0.6),
    0 0 20px rgba(255,215,0,0.8);

  transform: perspective(800px) rotateX(15deg);
  opacity: 0;
  transition: opacity 1.5s ease, transform 1.5s ease;
}

#greeting.show {
  opacity: 1;
  transform: perspective(800px) rotateX(0deg);
}

@keyframes glow {
  from {
    text-shadow:
      0 0 10px #fff,
      0 0 20px #ffe066,
      0 0 40px #ffd700;
  }
  to {
    text-shadow:
      0 0 20px #fff,
      0 0 40px #ffe066,
      0 0 80px #ffd700;
  }
}

#greeting.glow {
  animation: glow 2.5s infinite alternate;
}

/* CANVAS */
canvas {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 1;
}
</style>
</head>

<body>

<button id="startBtn"
onclick="
  this.style.display='none';
  document.getElementById('greeting').classList.add('show','glow');
  const a=document.getElementById('music');
  a.play();
  startFireworks(a);
">
▶ Включить музыку
</button>

<div id="greeting">
  С Праздником<br>святого Николая!
</div>

<audio id="music" src="music.mp3" preload="auto"></audio>
<canvas id="canvas"></canvas>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

function resize(){
  canvas.width = innerWidth;
  canvas.height = innerHeight;
}
resize();
addEventListener('resize', resize);

let particles = [];
let rockets = [];

/* РАКЕТЫ */
class Rocket {
  constructor() {
    this.x = Math.random() * canvas.width;
    this.y = canvas.height;
    this.vy = -(Math.random() * 6 + 8);
    this.color = `hsl(${Math.random()*360},100%,60%)`;
  }
  update() {
    this.y += this.vy;
    this.vy += 0.15;
    if (this.vy >= 0) {
      explode(this.x, this.y, this.color);
      return false;
    }
    return true;
  }
  draw() {
    ctx.save();
    ctx.shadowColor = this.color;
    ctx.shadowBlur = 15;
    ctx.fillStyle = this.color;
    ctx.beginPath();
    ctx.arc(this.x, this.y, 3, 0, Math.PI*2);
    ctx.fill();
    ctx.restore();
  }
}

/* ЧАСТИЦЫ */
class Particle {
  constructor(x,y,color){
    this.x=x; this.y=y;
    this.vx=(Math.random()-0.5)*6;
    this.vy=(Math.random()-0.5)*6;
    this.life=100;
    this.alpha=1;
    this.color=color;
  }
  update(){
    this.x+=this.vx;
    this.y+=this.vy;
    this.vy+=0.05;
    this.alpha-=0.015;
    this.life--;
  }
  draw(){
    ctx.save();
    ctx.globalAlpha=this.alpha;
    ctx.shadowColor=this.color;
    ctx.shadowBlur=20;
    ctx.fillStyle=this.color;
    ctx.beginPath();
    ctx.arc(this.x,this.y,3,0,Math.PI*2);
    ctx.fill();
    ctx.restore();
  }
}

function explode(x,y,color){
  for(let i=0;i<80;i++){
    particles.push(new Particle(x,y,color));
  }
}

/* АНИМАЦИЯ */
function animate(){
  ctx.fillStyle='rgba(0,0,0,0.25)';
  ctx.fillRect(0,0,canvas.width,canvas.height);

  rockets = rockets.filter(r=>{
    r.draw();
    return r.update();
  });

  particles = particles.filter(p=>p.life>0);
  particles.forEach(p=>{
    p.update();
    p.draw();
  });

  requestAnimationFrame(animate);
}
animate();

/* СИНХРОНИЗАЦИЯ С МУЗЫКОЙ */
function startFireworks(audio){
  let last = 0;

  audio.addEventListener('timeupdate', ()=>{
    const beat = 0.6;
    if(audio.currentTime - last > beat){
      rockets.push(new Rocket());
      last = audio.currentTime;
    }
  });

  audio.addEventListener('ended', ()=>{
    for(let i=0;i<10;i++){
      setTimeout(()=>rockets.push(new Rocket()), i*250);
    }
  });
}
</script>

</body>
</html>

